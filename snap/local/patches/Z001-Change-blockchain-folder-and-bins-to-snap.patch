From 72a5370bf0344d9331c80588cd5f09817cc64adf Mon Sep 17 00:00:00 2001
From: cevap <dev@i2pmail.org>
Date: Mon, 2 Dec 2019 19:13:48 +0100
Subject: [PATCH] Change blockchain folder and bins to snap

---
 src/main/blockchain/blockchain.js | 6 +++---
 src/main/blockchain/daemon.js     | 8 ++++----
 src/main/index.js                 | 4 ++--
 3 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/src/main/blockchain/blockchain.js b/src/main/blockchain/blockchain.js
index 4641c42..d53c3dd 100755
--- a/src/main/blockchain/blockchain.js
+++ b/src/main/blockchain/blockchain.js
@@ -5,8 +5,8 @@ import PropertiesReader from 'properties-reader';
 let testnet = 0;
 let rpcUser = uuidv4();
 let rpcPass = uuidv4();
-const daemonName = 'wagerrd';
-const cliName = 'wagerr-cli';
+const daemonName = 'wagerr.daemon';
+const cliName = 'wagerr.cli';
 const mnoCollateral = 25000;
 let rpcPort = 55003;
 const minTxFee = 0.0001;
@@ -124,7 +124,7 @@ function getWagerrDataPath() {
       return path.join(environment.ENV.APPDATA, 'wagerr');
     }
     case 'linux': {
-      return path.join(environment.ENV.HOME, '.wagerr');
+      return path.join(environment.ENV.HOME, 'snap/wagerr/common/.wagerr');
     }
     default: {
       console.log('Unsupported platform!');
diff --git a/src/main/blockchain/daemon.js b/src/main/blockchain/daemon.js
index c5d0145..1f0cc14 100755
--- a/src/main/blockchain/daemon.js
+++ b/src/main/blockchain/daemon.js
@@ -22,7 +22,7 @@ export default class Daemon {
    */
   runCommand(cmd) {
     return new Promise(async resolve => {
-      const cliPath = this.getExecutablePath('wagerr-cli');
+      const cliPath = this.getExecutablePath('wagerr.cli');
       console.log(
         'Confirm the cli params',
         blockchain.rpcUser,
@@ -56,7 +56,7 @@ export default class Daemon {
   }
 
   launch(args) {
-    const wagerrdPath = this.getExecutablePath('wagerrd');
+    const wagerrdPath = this.getExecutablePath('wagerr.daemon');
     const wagerrdArgs = this.getWagerrdArgs(args);
 
     console.log(`\x1b[32m Launching daemon: ${wagerrdPath}\x1b[32m`);
@@ -89,7 +89,7 @@ export default class Daemon {
   stop() {
     return new Promise(async resolve => {
       let running = true;
-      const cliPath = this.getExecutablePath('wagerr-cli');
+      const cliPath = this.getExecutablePath('wagerr.cli');
 
       // Call wagerr cli to stop the wagerr daemon.
       const wagerrcliProcess = spawn(cliPath, [
@@ -118,7 +118,7 @@ export default class Daemon {
   getExecutablePath(name) {
     const binPath =
       process.env.NODE_ENV === 'development'
-        ? path.join(__dirname, '..', '..', '..', 'bin')
+        ? path.join(__dirname, '/snap/bin')
         : path.join(process.resourcesPath, 'bin');
     const execName = os.platform() !== 'win32' ? name : `${name}.exe`;
 
diff --git a/src/main/index.js b/src/main/index.js
index 4054b44..9668942 100644
--- a/src/main/index.js
+++ b/src/main/index.js
@@ -155,8 +155,8 @@ export async function init(args) {
   daemon = new Daemon();
 
   // Check if the wagerrd binary exists.
-  const wagerrExe = daemon.getExecutablePath('wagerrd');
-  const wagerrcliExe = daemon.getExecutablePath('wagerr-cli');
+  const wagerrExe = daemon.getExecutablePath('wagerr.daemon');
+  const wagerrcliExe = daemon.getExecutablePath('wagerr.cli');
 
   if (!fs.existsSync(wagerrExe) || !fs.existsSync(wagerrcliExe)) {
     logger.error(
-- 
2.17.1

